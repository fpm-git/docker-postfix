name: 'Setup docker buildx'
description: 'Setup docker buildx'

runs:
  using: "composite"
  steps:
    - name: Set up QEMU
      uses: docker/setup-qemu-action@v3

    - name: Set up Docker Buildx
      id: buildx
      uses: docker/setup-buildx-action@v3
      with:
        install: true
        use: true

    # Install dependencies for QEMU and ARM
    - name: Install QEMU and ARM libraries
      shell: bash
      run: |
        sudo apt-get update
        sudo apt-get install -y qemu-user-static $(apt-cache search --names-only 'libc.*-armhf.*' | grep -v -E -- '-(dbg|dev)' | awk '{ print $1 }')

    # Release version setup
    - uses: ./.github/actions/get-release-version
