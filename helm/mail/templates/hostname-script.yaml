{{- $chart := "mail" -}}
{{- $fullName := include (print $chart ".fullname") . -}}
{{- $labels := include (print $chart ".labels") . -}}
apiVersion: v1
kind: ConfigMap
metadata:
  name: hostname-init
  labels:
    {{- $labels | nindent 4 }}
data:
  set_hostname.sh: |
    #!/usr/bin/env bash

    # Load the hostname from the file
    if [ -f /var/worker-ip/hostname.txt ]; then
        export FULL_HOSTNAME=$(cat /var/worker-ip/hostname.txt)
    fi

    # Execute the main container command
    exec "$@"
